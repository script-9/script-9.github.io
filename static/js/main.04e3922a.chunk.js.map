{"version":3,"sources":["images/logo.png","images/tanks.gif","images/8bomb.gif","images/dungeon.gif","images/porklike.gif","images/supplies.gif","images/loshermanosbros-lite.gif","images/livecoding480.gif","images/slider480.gif","images/pauserewind.gif","images/toggle.gif","images/spritedemo.gif","images/mapdemo.gif","images/musicdemo.gif","components/NavLink.js","utils/network.js","utils/isCassetteDirty.js","components/Nav.js","components/Home.js","utils/getLintErrors.js","components/Editor.js","components/Canvas.js","components/Output.js","components/Code.js","components/Run.js","components/Oauth.js","utils/useStateWithLocalStorage.js","App.js","utils/demoCode.js","serviceWorker.js","index.js"],"names":["module","exports","NavLink","props","getProps","location","href","origin","pathname","search","join","endsWith","className","fetchGithubAppAccessToken","code","a","fetch","process","method","body","JSON","stringify","response","status","json","Error","statusText","assembleGistPayload","cassette","public","description","files","content","contents","fetchFavicon","ok","fetchGist","gistId","url","editGist","token","payload","options","headers","Authorization","id","gist","createGist","saveGist","isCassetteDirty","idbId","idb","idbCassette","isDirty","Nav","path","setCassette","useState","setIsDirty","useEffect","window","URLSearchParams","get","network","then","catch","error","console","log","navigate","to","Home","version","timestamp","src","logo","alt","loshermanosbrosgif","bombgif","dungeongif","tanksgif","suppliesgif","porklikegif","livecoding480","slider480","pauserewind","toggle","spritedemo","mapdemo","musicdemo","parseOptions","ecmaVersion","sourceType","locations","getLintErrors","text","errors","acorn","push","from","line","loc","ch","column","raisedAt","message","replace","severity","Editor","codeMirrorDiv","useRef","codeMirrorRef","CodeMirror","registerHelper","current","value","mode","theme","lint","lineNumbers","tabSize","cursorBlinkRate","scrollbarStyle","on","cm","getValue","ref","Canvas","forwardRef","canvasRef","_pixelData","ImageData","useImperativeHandle","draw","_pixelBytes","data","set","getContext","putImageData","width","height","Output","workerRef","pixelBytesRef","sentAtRef","duration","setDuration","initWorker","Worker","onmessage","e","Date","now","m","received","length","postMessage","setTimeout","terminate","Code","Run","Oauth","setCommentsToken","access_token","useStateWithLocalStorage","localStorageKey","compoundKey","localStorage","getItem","setValue","setItem","App","commentsToken","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","rootElement","document","getElementById","hasChildNodes","hydrate","render","URL","addEventListener","contentType","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.04e3922a.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlAAAAAoCAIAAAC+blOXAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBQTRCNkU3RDBEOTExMUU5Qjk3MkFERTEyRkI4RjBCQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBQTRCNkU3RTBEOTExMUU5Qjk3MkFERTEyRkI4RjBCQSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkFBNEI2RTdCMEQ5MTExRTlCOTcyQURFMTJGQjhGMEJBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkFBNEI2RTdDMEQ5MTExRTlCOTcyQURFMTJGQjhGMEJBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+HvluxAAAAUhJREFUeNrs3TFOQkEQgGEwL7RIaAxHsJDiWXsZzsVJ6Kx5hRYcwdAQpDKhorGE4pFZ1sHvKzGZLFL82WKyw5/NahBh8rY4+/n+fWn+Hc8vLfv5a4n6v3VdFzJn87kPmbPdHUPmrL9izvNx+A6ZMx8/hsx5nU1C5jxNRyFznl9iztO2bcichwEA/AOCB4DgAYDgAYDgAYDgAYDgAUAJzaU/lN5bqjW/735S3zlR3yv7+UsrvXcIuOEBgOABgOABgOABgOABgOABgOABwK+Le3hR+161ZN8zy7JPVuu9Ovt2gBseAAgeAIIHAIIHAIIHAIIHAIIHADfS3Ov+U/Z34LK/S/fXfl8ANzwABA8ABA8ABA8ABA8ABA8ABA8ArtTU2lvK8t5e33Nmf4cvC/t2gBseAAgeAIIHAIIHAIIHAIIHAIIHADdyEmAARD5eRI/K+WsAAAAASUVORK5CYII=\"","module.exports = __webpack_public_path__ + \"static/media/tanks.5da68a3d.gif\";","module.exports = __webpack_public_path__ + \"static/media/8bomb.5025e955.gif\";","module.exports = __webpack_public_path__ + \"static/media/dungeon.98e9f8a6.gif\";","module.exports = __webpack_public_path__ + \"static/media/porklike.5577896b.gif\";","module.exports = __webpack_public_path__ + \"static/media/supplies.c4b71463.gif\";","module.exports = __webpack_public_path__ + \"static/media/loshermanosbros-lite.c3b13663.gif\";","module.exports = __webpack_public_path__ + \"static/media/livecoding480.20d1866a.gif\";","module.exports = __webpack_public_path__ + \"static/media/slider480.dc4d8c4b.gif\";","module.exports = __webpack_public_path__ + \"static/media/pauserewind.741e69fa.gif\";","module.exports = __webpack_public_path__ + \"static/media/toggle.4ab6d6b6.gif\";","module.exports = __webpack_public_path__ + \"static/media/spritedemo.76159464.gif\";","module.exports = __webpack_public_path__ + \"static/media/mapdemo.23680514.gif\";","module.exports = __webpack_public_path__ + \"static/media/musicdemo.c1b0f3bd.gif\";","import React from 'react'\nimport { Link } from '@reach/router'\n\nconst NavLink = props => (\n  <Link\n    {...props}\n    getProps={({ location, href }) => {\n      const { origin, pathname, search } = location\n      return [origin, pathname, search].join('').endsWith(href)\n        ? { className: 'active' }\n        : null\n    }}\n  />\n)\n\nexport default NavLink\n","const fetchGithubAppAccessToken = async code => {\n  try {\n    const response = await fetch(\n      `${process.env.REACT_APP_NOW}/api/oauth-comments`,\n      {\n        method: 'POST',\n        body: JSON.stringify({ code }),\n      },\n    )\n    if (response.status === 200) {\n      const json = await response.json()\n      return json\n    } else {\n      throw new Error(`${response.status}: ${response.statusText}`)\n    }\n  } catch (error) {\n    throw error\n  }\n}\n\nconst assembleGistPayload = cassette => ({\n  public: true,\n  description: 'SCRIPT-9',\n  files: {\n    'code.json': {\n      content: cassette.contents.code,\n    },\n  },\n})\n\nconst fetchFavicon = async () => {\n  try {\n    const response = await fetch('/img/favicon.co')\n    if (!response.ok) {\n      throw new Error(response.statusText)\n    }\n    return response\n  } catch (error) {\n    throw error\n  }\n}\n\nconst fetchGist = async gistId => {\n  const url = `https://api.github.com/gists/${gistId}`\n  const response = await fetch(url)\n  if (response.status === 200) {\n    const json = await response.json()\n    return json\n  } else {\n    throw new Error(`${response.status}: ${response.statusText}`)\n  }\n}\n\nconst editGist = async ({ cassette, token }) => {\n  const payload = assembleGistPayload(cassette)\n  const options = {\n    headers: {\n      Authorization: `token ${token}`,\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify(payload),\n  }\n  const id = cassette.gist?.id || cassette.gistId\n  const url = `https://api.github.com/gists/${id}`\n  options.method = 'PATCH'\n  const response = await fetch(url, options)\n  if (response.status === 200) {\n    const json = await response.json()\n    return json\n  } else {\n    throw new Error(`${response.status}: ${response.statusText}`)\n  }\n}\n\nconst createGist = async ({ cassette, token }) => {\n  const payload = assembleGistPayload(cassette)\n  const options = {\n    headers: {\n      Authorization: `token ${token}`,\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify(payload),\n  }\n  const url = `https://api.github.com/gists`\n  options.method = 'POST'\n  const response = await fetch(url, options)\n  if (response.status === 201) {\n    const json = await response.json()\n    return json\n  } else {\n    throw new Error(`${response.status}: ${response.statusText}`)\n  }\n}\n\nconst saveGist = async ({ cassette, token }) => {\n  if (cassette.gist || cassette.gistId) {\n    return await editGist({ cassette, token })\n  } else {\n    return await createGist({ cassette, token })\n  }\n}\n\nexport default { fetchGist, saveGist, fetchFavicon, fetchGithubAppAccessToken }\n","import * as idb from 'idb-keyval'\n\nconst isCassetteDirty = async cassette => {\n  if (!cassette) {\n    return false\n  } else {\n    if (cassette.idbId) {\n      const idbCassette = await idb.get(cassette.idbId)\n      const isDirty = cassette.contents.code !== idbCassette.contents.code\n      return isDirty\n    } else if (cassette.gist) {\n      const isDirty =\n        cassette.contents &&\n        cassette.contents.code !== cassette.gist.files['code.json'].content\n      return isDirty\n    } else {\n      return !!cassette.contents.code\n    }\n  }\n}\n\nexport default isCassetteDirty\n","import React, { useEffect, useState } from 'react'\nimport { navigate } from '@reach/router'\n// import * as idb from 'idb-keyval'\nimport NavLink from './NavLink'\nimport network from './../utils/network'\n// import uuid from './../utils/uuid'\nimport isCassetteDirty from './../utils/isCassetteDirty'\n\nconst Nav = props => {\n  const { path, location, cassette, setCassette } = props\n  const [, setIsDirty] = useState(false)\n\n  useEffect(() => {\n    const { search } = location\n    const params = new window.URLSearchParams(search)\n    const id = params.get('id')\n    if (!cassette?.gist && id) {\n      network\n        .fetchGist(id)\n        .then(gist => {\n          setCassette((cassette = {}) => ({\n            ...cassette,\n            gist,\n            contents: {\n              ...(cassette ? cassette.contents : {}),\n              code: gist.files['code.json'].content,\n            },\n          }))\n        })\n        .catch(error => {\n          console.log({ error })\n        })\n    }\n  }, [cassette, setCassette, location])\n\n  useEffect(() => {\n    if (cassette?.gist) {\n      navigate(`${path}?id=${cassette.gist.id}`)\n    } else {\n      navigate(`${path}`)\n    }\n  }, [cassette, path])\n\n  useEffect(() => {\n    isCassetteDirty(cassette).then(setIsDirty)\n  }, [cassette])\n\n  // const handleNew = () => {\n  //   setCassette(null)\n  // }\n\n  // const handleSave = async () => {\n  //   try {\n  //     // If save goes through:\n  //     // - remove cassette from idb\n  //     // - remove its idbId\n  //     const gist = await network.saveGist({ cassette, token })\n  //     if (cassette.idbId) {\n  //       await idb.del(cassette.idbId)\n  //     }\n  //     const updatedCassette = {\n  //       ...cassette,\n  //       gist,\n  //       idbId: null,\n  //     }\n  //     setCassette(updatedCassette)\n  //   } catch (error) {\n  //     // If save fails:\n  //     // - give cassette an idbId\n  //     // - remove the gist part, but keep gistId\n  //     // - put cassette in idb\n  //     const updatedCassette = {\n  //       ...cassette,\n  //       idbUpdatedAt: Date.now(),\n  //       idbId: cassette.idbId || uuid(),\n  //       gist: null,\n  //       gistId: (cassette.gist?.id) || null,\n  //     }\n  //     await idb.set(updatedCassette.idbId, updatedCassette)\n  //     setCassette(updatedCassette)\n  //   }\n  // }\n\n  // const isNew = !cassette || !(cassette.contents?.code)\n  // const canSave = (!isNew && isDirty) || (!isNew && cassette.idbId)\n\n  return (\n    <nav>\n      <div className=\"pages\">\n        <ul>\n          <li>\n            <NavLink to={cassette?.gist ? `/?id=${cassette.gist.id}` : '/'}>\n              SCRIPT-8\n            </NavLink>\n          </li>\n          <li>\n            <NavLink\n              to={cassette?.gist ? `/code?id=${cassette.gist.id}` : '/code'}\n            >\n              Code\n            </NavLink>\n          </li>\n          {/* <li>\n            <NavLink\n              to={\n                cassette && cassette.gist\n                  ? `/shelf?id=${cassette.gist.id}`\n                  : '/shelf'\n              }\n            >\n              Shelf\n            </NavLink>\n          </li> */}\n          <li>\n            <NavLink\n              to={cassette?.gist ? `/run?id=${cassette.gist.id}` : '/run'}\n            >\n              Run\n            </NavLink>\n          </li>\n          {/* <li>\n            <a href={`${process.env.REACT_APP_NOW}/api/oauth-authorize`}>\n              comments-login\n            </a>\n          </li> */}\n        </ul>\n      </div>\n      {/* {<div>v{version}</div>} */}\n      {/* <div className=\"buttons\">\n        <ul>\n          {isDirty && <li>*</li>}\n          <li>\n            <button disabled={isNew} onClick={handleNew}>\n              New\n            </button>\n          </li>\n          <li>\n            <button disabled={!canSave} onClick={handleSave}>\n              Save\n            </button>\n          </li>\n        </ul>\n      </div> */}\n    </nav>\n  )\n}\n\nexport default Nav\n","import React, { useEffect } from 'react'\nimport Nav from './Nav'\nimport logo from '../images/logo.png'\nimport tanksgif from '../images/tanks.gif'\nimport bombgif from '../images/8bomb.gif'\nimport dungeongif from '../images/dungeon.gif'\nimport porklikegif from '../images/porklike.gif'\nimport suppliesgif from '../images/supplies.gif'\nimport loshermanosbrosgif from '../images/loshermanosbros-lite.gif'\nimport livecoding480 from '../images/livecoding480.gif'\nimport slider480 from '../images/slider480.gif'\nimport pauserewind from '../images/pauserewind.gif'\nimport toggle from '../images/toggle.gif'\nimport spritedemo from '../images/spritedemo.gif'\nimport mapdemo from '../images/mapdemo.gif'\nimport musicdemo from '../images/musicdemo.gif'\n// import testFunction from '../utils/testFunction'\n\n// eslint-disable-next-line import/no-webpack-loader-syntax\n// import worker from 'workerize-loader!../workers/worker'\n\nconst Home = props => {\n  const { version, timestamp } = props\n\n  useEffect(() => {\n    // let instance = worker() // `new` is optional\n    // instance.run(testFunction).then(value => {\n    //   console.log({ value })\n    // })\n    // instance.expensive(1000).then(count => {\n    //   console.log(`Ran ${count} loops`)\n    // })\n  }, [])\n\n  return (\n    <div className=\"Home\">\n      <Nav {...props} />\n      <h1>SCRIPT-8</h1>\n      <div className=\"logo-and-timestamp\">\n        <img src={logo} alt=\"SCRIPT-8 logo\" />\n        <span>updated {timestamp}</span>\n        <span>v{version}</span>\n      </div>\n      <p>\n        (NOTICE: You're looking at the beta version. This is where I test new\n        features. Go to <a href=\"https://script-8.github.io\">SCRIPT-8</a> for\n        the full experience.)\n      </p>\n      <p>\n        SCRIPT-8 is a fantasy computer for making, sharing, and playing tiny\n        retro-looking games (called cassettes). It's free, browser-based, and{' '}\n        <a href=\"https://github.com/script-8/script-8.github.io\">open-source</a>\n        . Cassettes are written in JavaScript.\n      </p>\n      <p className=\"thumbnails\">\n        <img src={loshermanosbrosgif} alt=\"Los hermanos bros game gif\" />\n        <img src={bombgif} alt=\"8-bomb game gif\" />\n        <img src={dungeongif} alt=\"dungeon game gif\" />\n        <img src={tanksgif} alt=\"tanks game gif\" />\n        <img src={suppliesgif} alt=\"supplies game gif\" />\n        <img src={porklikegif} alt=\"porklike game gif\" />\n      </p>\n      <p>\n        SCRIPT-8 is designed to encourage play — the kind of wonder-filled play\n        children experience as they explore and learn about the world. In order\n        to support this goal, everything in SCRIPT-8 has immediate feedback. It\n        is what some call a \"livecoding\" environment.\n      </p>\n      <p>It features:</p>\n      <p className=\"feature\">\n        <span>a code editor where the game changes as you type.</span>\n        <img src={livecoding480} alt=\"livecoding\" />\n      </p>\n      <p className=\"feature\">\n        <span>a slider to help you tweak numbers without typing.</span>\n        <img src={slider480} alt=\"slider\" />\n      </p>\n      <p className=\"feature\">\n        <span>a time-traveling tool so you can pause and rewind.</span>\n        <img src={pauserewind} alt=\"pause and rewind\" />\n      </p>\n      <p className=\"feature\">\n        <span>buttons that show a character's past and future paths.</span>\n        <img src={toggle} alt=\"toggle\" />\n      </p>\n      <p className=\"feature\">\n        <span>\n          a sprite editor where the game instantly displays your edits.\n        </span>\n        <img src={spritedemo} alt=\"sprite demo\" />\n      </p>\n      <p className=\"feature\">\n        <span>\n          a map editor where changes alter the game's behavior, in real-time.\n        </span>\n        <img src={mapdemo} alt=\"map demo\" />\n      </p>\n      <p className=\"feature\">\n        <span>\n          a music editor where you create phrases, group them into chains, and\n          turn those into songs.\n        </span>\n        <img src={musicdemo} alt=\"music demo\" />\n      </p>\n      <p>Each cassette is recorded to a URL you can share with anyone.</p>\n      <p>Play cassettes with a keyboard or gamepad.</p>\n      <p>\n        You can inspect any cassette's contents (even if it's not yours), change\n        the code, art, or music, and record it to a different cassette — a new\n        version.\n      </p>\n      <p>\n        SCRIPT-8 is heavily influenced by Bret Victor's ideas (specifically{' '}\n        <a href=\"http://vimeo.com/36579366\">Inventing on principle</a> and{' '}\n        <a className=\"text\" href=\"http://worrydream.com/LearnableProgramming/\">\n          Learnable programming\n        </a>\n        ) and Joseph White's{' '}\n        <a href=\"https://www.lexaloffle.com/pico-8.php\">PICO-8</a>, the best of\n        all fantasy consoles.\n      </p>\n      <p>\n        SCRIPT-8 is written by Gabriel Florit (that's me!) and{' '}\n        <a\n          className=\"text\"\n          href=\"https://github.com/script-8/script-8.github.io/graphs/contributors\"\n        >\n          dedicated contributors\n        </a>\n        . Click{' '}\n        <a href=\"https://twitter.com/gabrielflorit\">\n          https://twitter.com/gabrielflorit\n        </a>{' '}\n        to follow me on twitter. And visit the Github repository,{' '}\n        <a\n          className=\"text\"\n          href=\"https://github.com/script-8/script-8.github.io\"\n        >\n          https://github.com/script-8/script-8.github.io\n        </a>\n        , where you can keep up with new features and the occasional bug fix.\n      </p>\n      <p>\n        If you have any questions, come join us on the{' '}\n        <a href=\"https://discord.gg/HA68FNX\">Fantasy Consoles Discord server</a>\n        , a friendly place to chat about these sophisticated, cutting-edge\n        computers. The server has a dedicated SCRIPT-8 room.\n      </p>\n      <p>\n        SCRIPT-8 nyx8 palette by{' '}\n        <a href=\"https://twitter.com/Xavier_Gd\">Javier Guerrero</a>. Sprites in{' '}\n        <a\n          className=\"text\"\n          href=\"https://script-8.github.io/?id=cd8d6811adb3afb472aaf7505729cf01\"\n        >\n          Los Hermanos Bros.\n        </a>{' '}\n        by <a href=\"https://twitter.com/johanvinet\">Johan Vinet</a>.\n      </p>\n    </div>\n  )\n}\n\nexport default Home\n","import * as acorn from 'acorn'\n\nconst parseOptions = {\n  ecmaVersion: 10,\n  sourceType: 'script',\n  locations: true,\n}\n\nconst getLintErrors = text => {\n  const errors = []\n  try {\n    acorn.parse(text, parseOptions)\n  } catch (error) {\n    errors.push({\n      from: {\n        line: error.loc.line - 1,\n        ch: error.loc.column,\n      },\n      to: {\n        line: error.loc.line - 1,\n        ch: error.raisedAt,\n      },\n      message: error.message.replace(/ \\(\\d+:\\d+\\)$/, ''),\n      severity: 'error',\n    })\n  }\n\n  return errors\n}\n\nexport default getLintErrors\n","import React, { useEffect, useRef } from 'react'\nimport getLintErrors from './../utils/getLintErrors'\n\nconst Editor = props => {\n  const { cassette, setCassette } = props\n\n  const codeMirrorDiv = useRef()\n  const codeMirrorRef = useRef()\n\n  useEffect(() => {\n    window.CodeMirror.registerHelper('lint', 'javascript', getLintErrors)\n    codeMirrorRef.current = window.CodeMirror(codeMirrorDiv.current, {\n      value: cassette?.contents?.code || '',\n      mode: 'javascript',\n      theme: 'nyx8',\n      lint: true,\n      lineNumbers: true,\n      tabSize: 2,\n      cursorBlinkRate: 0,\n      scrollbarStyle: null,\n    })\n\n    codeMirrorRef.current.on('changes', cm => {\n      const content = cm.getValue()\n      setCassette((cassette = {}) => ({\n        ...cassette,\n        contents: {\n          code: content,\n        },\n      }))\n    })\n  }, [])\n\n  return (\n    <div className=\"Editor\">\n      <div ref={codeMirrorDiv} />\n    </div>\n  )\n}\n\nexport default Editor\n","import React, {\n  useRef,\n  useImperativeHandle,\n  forwardRef,\n  useEffect,\n} from 'react'\n\nconst Canvas = forwardRef((props, ref) => {\n  const canvasRef = useRef()\n  const _pixelData = useRef()\n\n  useEffect(() => {\n    _pixelData.current = new ImageData(128, 128)\n  }, [])\n\n  useImperativeHandle(ref, () => ({\n    draw: _pixelBytes => {\n      _pixelData.current.data.set(_pixelBytes)\n      const ctx = canvasRef.current.getContext('2d')\n      ctx.putImageData(_pixelData.current, 0, 0)\n    },\n  }))\n  return <canvas width={128} height={128} ref={canvasRef} />\n})\n\nexport default Canvas\n","import React, { useRef, useEffect, useState } from 'react'\nimport Canvas from './Canvas'\nimport getLintErrors from './../utils/getLintErrors'\n\nconst Output = props => {\n  const { cassette } = props\n\n  const canvasRef = useRef()\n  const workerRef = useRef()\n  const pixelBytesRef = useRef()\n  const sentAtRef = useRef()\n\n  const [duration, setDuration] = useState(null)\n\n  const initWorker = () => {\n    console.log('initing')\n    workerRef.current = new Worker('js/worker.js')\n    workerRef.current.onmessage = function(e) {\n      if (e.data[0]) {\n        pixelBytesRef.current = e.data[0]\n        canvasRef.current.draw(pixelBytesRef.current)\n        setDuration(Date.now() - e.data[1])\n        console.log({\n          m: 'received',\n          sentAtRef: sentAtRef.current,\n          received: e.data[1],\n        })\n        if (e.data[1] === sentAtRef.current) {\n          sentAtRef.current = null\n        }\n      } else {\n        // We got an error!\n        console.log({ m: 'error', error: e.data[2] })\n        if (e.data[1] === sentAtRef.current) {\n          sentAtRef.current = null\n        }\n      }\n    }\n  }\n\n  useEffect(() => {\n    initWorker()\n  }, [])\n\n  // When the cassette changes,\n  useEffect(() => {\n    // if we have cassette code and a webworker,\n    const code = cassette?.contents?.code\n    if (workerRef.current && code) {\n      // see if the code has lint errors.\n      const errors = getLintErrors(code)\n      // If it doesn't,\n      if (!errors.length) {\n        console.log({ cassette })\n        // send the code to the webworker,\n        // and in order to stop the worker if it's taking too long,\n        // we need to know when we sent this message.\n        // Send the timestamp but also keep it here.\n        sentAtRef.current = Date.now()\n        workerRef.current.postMessage([code, sentAtRef.current])\n        console.log({ m: 'sent message:', sentAtRef: sentAtRef.current })\n        console.log('waiting for timeout')\n        setTimeout(() => {\n          if (sentAtRef.current) {\n            console.log({ m: 'terminating', sentAtRef: sentAtRef.current })\n            workerRef.current.terminate()\n            initWorker()\n            // terminate worker\n          }\n        }, 2000)\n      }\n    }\n  }, [cassette])\n\n  return (\n    <div className=\"Output\">\n      <Canvas ref={canvasRef} />\n      <div>1 frame takes {duration}ms</div>\n    </div>\n  )\n}\n\nexport default Output\n// const handleClick = method => {\n//   const before = Date.now()\n//   setRoundtrips(null)\n//   setDuration(null)\n\n//   let _roundtrips = 0\n//   let stop = false\n//   const intervalId = setInterval(() => {\n//     workerRef.current.postMessage(method)\n\n//     workerRef.current.onmessage = function(e) {\n//       if (!stop) {\n//         pixelBytesRef.current = e.data\n//         canvasRef.current.draw(pixelBytesRef.current)\n//         _roundtrips++\n//         const after = Date.now()\n//         const delta = after - before\n//         if (delta > 1000 * 5) {\n//           stop = true\n//           clearInterval(intervalId)\n//           setRoundtrips(_roundtrips)\n//           setDuration(delta)\n//         }\n//       }\n//     }\n//   }, 0)\n","import React from 'react'\nimport Editor from './Editor'\nimport Output from './Output'\nimport Nav from './Nav'\n\nconst Code = props => {\n  return (\n    <div className=\"Code\">\n      <Nav {...props} />\n      <Editor {...props} />\n      <Output {...props} />\n    </div>\n  )\n}\n\nexport default Code\n","import React from 'react'\nimport Nav from './Nav'\nimport Output from './Output'\n\nconst Run = props => {\n  return (\n    <div className=\"Run\">\n      <Nav {...props} />\n      <Output {...props} />\n    </div>\n  )\n}\n\nexport default Run\n","import React, { useEffect } from 'react'\nimport network from '../utils/network'\nimport { navigate } from '@reach/router'\n\nconst Oauth = props => {\n  const { location, setCommentsToken } = props\n\n  useEffect(() => {\n    const { search } = location\n    const params = new window.URLSearchParams(search)\n    const code = params.get('code')\n\n    if (code) {\n      // This means the user clicked login and was redirected here.\n      // We now need to ask for access token.\n      network\n        .fetchGithubAppAccessToken(code)\n        .then(json => {\n          setCommentsToken(json.access_token)\n          navigate('/')\n        })\n        .catch(error => {\n          console.log({ error })\n        })\n    }\n  }, [location, setCommentsToken])\n\n  return (\n    <>\n      <div className=\"Oauth\">\n        <h1>Oauth</h1>\n      </div>\n    </>\n  )\n}\n\nexport default Oauth\n","import { useState, useEffect } from 'react'\n\nconst globalKey = 'script-9'\n\nconst useStateWithLocalStorage = localStorageKey => {\n  const compoundKey = `${globalKey}${localStorageKey}`\n\n  const [value, setValue] = useState(localStorage.getItem(compoundKey) || '')\n\n  useEffect(() => {\n    localStorage.setItem(compoundKey, value)\n  }, [value, compoundKey])\n\n  return [value, setValue]\n}\n\nexport default useStateWithLocalStorage\n","import React, { useState } from 'react'\nimport { Router } from '@reach/router'\nimport Home from './components/Home'\nimport Code from './components/Code'\nimport Run from './components/Run'\n// import Shelf from './components/Shelf'\nimport Oauth from './components/Oauth'\nimport useStateWithLocalStorage from './utils/useStateWithLocalStorage'\nimport demoCode from './utils/demoCode'\nimport { version } from './../package.json'\nimport { timestamp } from './utils/timestamp.json'\nimport './styl/App.css'\n\nconst App = () => {\n  const token = null\n  const [commentsToken, setCommentsToken] = useStateWithLocalStorage(\n    'comments-token',\n  )\n  const [cassette, setCassette] = useState({\n    contents: {\n      code: demoCode,\n    },\n  })\n\n  const props = {\n    timestamp,\n    version,\n    token,\n    cassette,\n    setCassette,\n    commentsToken,\n    setCommentsToken,\n  }\n  return (\n    <>\n      <Router>\n        <Home path=\"/\" {...props} />\n        <Code path=\"/code\" {...props} />\n        <Run path=\"/run\" {...props} />\n        <Oauth path=\"/oauth-comments\" {...props} />\n        {/* <Shelf path=\"/shelf\" {...props} /> */}\n      </Router>\n    </>\n  )\n}\n\nexport default App\n","const demoCode = `draw = () => {\n  print(60, 62, 'hi.', 0)\n}`\n\nexport default demoCode\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n)\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport { hydrate, render } from 'react-dom'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nconst rootElement = document.getElementById('root')\nif (rootElement.hasChildNodes()) {\n  hydrate(<App />, rootElement)\n} else {\n  render(<App />, rootElement)\n}\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register()\n"],"sourceRoot":""}